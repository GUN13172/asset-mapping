# ä¿®å¤è¯´æ˜

## å·²ä¿®å¤çš„é—®é¢˜

### âœ… é—®é¢˜1ï¼šå†å²è®°å½•ç•Œé¢åˆ‡æ¢åæ•°æ®ä¸¢å¤±

**ç°è±¡ï¼š**
- åœ¨"èµ„äº§æµ‹ç»˜"é¡µé¢æ‰§è¡ŒæŸ¥è¯¢åï¼Œåˆ‡æ¢åˆ°å…¶ä»–é¡µé¢
- å†åˆ‡æ¢å›æ¥æ—¶ï¼ŒæŸ¥è¯¢ç»“æœå’Œå†å²è®°å½•éƒ½æ¶ˆå¤±äº†

**æ ¹æœ¬åŸå› ï¼š**
åŸæ¥çš„ä»£ç ä½¿ç”¨åŠ¨æ€ç»„ä»¶æ¸²æŸ“æ–¹å¼ï¼š
```typescript
// æ—§ä»£ç  - æœ‰é—®é¢˜çš„å®ç°
const getCurrentComponent = () => {
  const item = menuItems.find(item => item.key === selectedKey);
  return item ? item.component : null;  // æ¯æ¬¡åˆ‡æ¢éƒ½åˆ›å»ºæ–°ç»„ä»¶
};

return <Content>{getCurrentComponent()}</Content>
```

è¿™ç§æ–¹å¼çš„é—®é¢˜ï¼š
1. æ¯æ¬¡åˆ‡æ¢é¡µé¢æ—¶ï¼Œæ—§ç»„ä»¶ä¼šè¢«å¸è½½ï¼ˆunmountï¼‰
2. æ–°é¡µé¢çš„ç»„ä»¶ä¼šé‡æ–°æŒ‚è½½ï¼ˆmountï¼‰
3. ç»„ä»¶çš„æ‰€æœ‰çŠ¶æ€ï¼ˆstateï¼‰éƒ½ä¼šä¸¢å¤±
4. åŒ…æ‹¬ï¼šæŸ¥è¯¢ç»“æœã€å†å²è®°å½•ã€è¡¨å•è¾“å…¥ç­‰

**è§£å†³æ–¹æ¡ˆï¼š**
æ”¹ç”¨æ¡ä»¶æ¸²æŸ“ï¼Œä¿æŒæ‰€æœ‰ç»„ä»¶å®ä¾‹ï¼š
```typescript
// æ–°ä»£ç  - ä¿®å¤åçš„å®ç°
const renderContent = () => {
  return (
    <>
      <div style={{ display: selectedKey === 'asset-query' ? 'block' : 'none' }}>
        <AssetQuery />
      </div>
      <div style={{ display: selectedKey === 'api-keys' ? 'block' : 'none' }}>
        <ApiKeyManagement />
      </div>
      <div style={{ display: selectedKey === 'export' ? 'block' : 'none' }}>
        <ExportData />
      </div>
      <div style={{ display: selectedKey === 'history' ? 'block' : 'none' }}>
        <HistoryRecords />
      </div>
      <div style={{ display: selectedKey === 'settings' ? 'block' : 'none' }}>
        <Settings />
      </div>
    </>
  );
};
```

è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹ï¼š
1. âœ… æ‰€æœ‰ç»„ä»¶åœ¨åº”ç”¨å¯åŠ¨æ—¶å°±æŒ‚è½½ï¼Œä¸ä¼šè¢«å¸è½½
2. âœ… åˆ‡æ¢é¡µé¢åªæ˜¯æ˜¾ç¤º/éšè—ï¼Œä¸å½±å“ç»„ä»¶çŠ¶æ€
3. âœ… æŸ¥è¯¢ç»“æœã€å†å²è®°å½•ç­‰æ•°æ®éƒ½ä¼šä¿ç•™
4. âœ… é¿å…é‡å¤çš„æ•°æ®åŠ è½½å’ŒAPIè°ƒç”¨

### âœ… é—®é¢˜2ï¼šç¼ºå°‘å†å²è®°å½•èœå•å…¥å£

**æ”¹è¿›ï¼š**
- æ·»åŠ äº†"å†å²è®°å½•"èœå•é¡¹åˆ°ä¾§è¾¹æ 
- ä½¿ç”¨ `HistoryOutlined` å›¾æ ‡
- ç°åœ¨ç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°æŸ¥çœ‹æ‰€æœ‰æŸ¥è¯¢å†å²

## APIå¯†é’¥æ£€æµ‹é—®é¢˜æ’æŸ¥

### å½“å‰çŠ¶æ€
DayDayMap APIå¯†é’¥éªŒè¯åŠŸèƒ½å·²ç»æ­£ç¡®å®ç°ï¼Œå¹¶é€šè¿‡äº†56ä¸ªæµ‹è¯•ã€‚å¦‚æœé‡åˆ°éªŒè¯å¤±è´¥ï¼Œå¯èƒ½æ˜¯ä»¥ä¸‹åŸå› ï¼š

### æ’æŸ¥æ­¥éª¤

#### 1. æ£€æŸ¥APIå¯†é’¥æ ¼å¼
ç¡®ä¿APIå¯†é’¥æ˜¯æœ‰æ•ˆçš„Bearer tokenæ ¼å¼ã€‚

#### 2. æ£€æŸ¥é…ç½®æ–‡ä»¶
é…ç½®æ–‡ä»¶ä½ç½®ï¼ˆæ ¹æ®æ“ä½œç³»ç»Ÿï¼‰ï¼š
- **macOS**: `~/Library/Application Support/asset-mapping/daydaymap_api.json`
- **Linux**: `~/.config/asset-mapping/daydaymap_api.json`
- **Windows**: `%APPDATA%\asset-mapping\daydaymap_api.json`

é…ç½®æ–‡ä»¶æ ¼å¼åº”è¯¥æ˜¯ï¼š
```json
{
  "api_keys": [
    "your_api_key_here"
  ]
}
```

#### 3. æ‰‹åŠ¨æµ‹è¯•APIè¿æ¥
ä½¿ç”¨curlå‘½ä»¤æµ‹è¯•ï¼š
```bash
curl -X GET "https://www.daydaymap.com/api/v1/user/info" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json"
```

æˆåŠŸçš„å“åº”åº”è¯¥ç±»ä¼¼ï¼š
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "credit": 1000,
    "username": "user@example.com"
  }
}
```

#### 4. æ£€æŸ¥ç½‘ç»œè¿æ¥
ç¡®ä¿å¯ä»¥è®¿é—® `https://www.daydaymap.com`

#### 5. æŸ¥çœ‹åº”ç”¨æ—¥å¿—
åœ¨å¼€å‘æ¨¡å¼ä¸‹è¿è¡Œåº”ç”¨æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯ï¼š
```bash
cd asset-mapping
npm run tauri dev
```

### å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ

| é”™è¯¯ä¿¡æ¯ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|---------|------|---------|
| "APIå¯†é’¥æ— æ•ˆæˆ–å·²è¿‡æœŸ" | APIå¯†é’¥é”™è¯¯æˆ–å·²è¿‡æœŸ | æ£€æŸ¥APIå¯†é’¥æ˜¯å¦æ­£ç¡®ï¼Œæˆ–é‡æ–°ç”³è¯· |
| "è¯·æ±‚å¤±è´¥: connection timeout" | ç½‘ç»œè¿æ¥é—®é¢˜ | æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œç¡®ä¿å¯ä»¥è®¿é—®DayDayMap |
| "æœªé…ç½®DayDayMap APIå¯†é’¥" | é…ç½®æ–‡ä»¶ä¸å­˜åœ¨æˆ–ä¸ºç©º | åœ¨åº”ç”¨ä¸­æ·»åŠ APIå¯†é’¥ |
| "è§£æJSONå¤±è´¥" | APIè¿”å›æ ¼å¼å¼‚å¸¸ | æ£€æŸ¥APIæ˜¯å¦æ­£å¸¸ï¼Œæˆ–è”ç³»DayDayMapæ”¯æŒ |

## æµ‹è¯•éªŒè¯

### æµ‹è¯•å†å²è®°å½•åŠŸèƒ½

1. **å¯åŠ¨åº”ç”¨**
   ```bash
   cd asset-mapping
   npm run tauri dev
   ```

2. **æ‰§è¡ŒæŸ¥è¯¢**
   - è¿›å…¥"èµ„äº§æµ‹ç»˜"é¡µé¢
   - é€‰æ‹©ä»»æ„å¹³å°ï¼ˆHunter/FOFA/Quake/DayDayMapï¼‰
   - è¾“å…¥æŸ¥è¯¢è¯­å¥ï¼Œç‚¹å‡»"æŸ¥è¯¢"

3. **åˆ‡æ¢é¡µé¢**
   - ç‚¹å‡»ä¾§è¾¹æ çš„"å†å²è®°å½•"
   - åº”è¯¥èƒ½çœ‹åˆ°åˆšæ‰çš„æŸ¥è¯¢è®°å½•

4. **éªŒè¯æ•°æ®ä¿ç•™**
   - åˆ‡æ¢åˆ°"APIå¯†é’¥ç®¡ç†"æˆ–å…¶ä»–é¡µé¢
   - å†åˆ‡æ¢å›"å†å²è®°å½•"
   - âœ… æ•°æ®åº”è¯¥ä»ç„¶å­˜åœ¨

5. **åˆ‡æ¢å›æŸ¥è¯¢é¡µé¢**
   - ç‚¹å‡»"èµ„äº§æµ‹ç»˜"
   - âœ… ä¹‹å‰çš„æŸ¥è¯¢ç»“æœåº”è¯¥è¿˜åœ¨

### æµ‹è¯•APIå¯†é’¥éªŒè¯

1. **æ·»åŠ APIå¯†é’¥**
   - è¿›å…¥"APIå¯†é’¥ç®¡ç†"é¡µé¢
   - é€‰æ‹©"DayDayMap"æ ‡ç­¾
   - ç‚¹å‡»"æ·»åŠ APIå¯†é’¥"
   - è¾“å…¥æœ‰æ•ˆçš„APIå¯†é’¥

2. **éªŒè¯å¯†é’¥**
   - ç‚¹å‡»"éªŒè¯"æŒ‰é’®
   - âœ… åº”è¯¥æ˜¾ç¤º"APIå¯†é’¥æœ‰æ•ˆ"å’Œå‰©ä½™é…é¢

3. **æ‰¹é‡éªŒè¯**
   - å¦‚æœæœ‰å¤šä¸ªå¯†é’¥ï¼Œç‚¹å‡»"éªŒè¯å…¨éƒ¨"
   - âœ… åº”è¯¥ä¾æ¬¡éªŒè¯æ‰€æœ‰å¯†é’¥

## é‡æ–°æ‰“åŒ…åº”ç”¨

å¦‚æœéœ€è¦é‡æ–°æ‰“åŒ…åº”ç”¨ä»¥åŒ…å«è¿™äº›ä¿®å¤ï¼š

```bash
cd asset-mapping

# 1. æ„å»ºå‰ç«¯
npm run build

# 2. æ‰“åŒ…åº”ç”¨
npm run tauri build
```

æ‰“åŒ…å®Œæˆåï¼Œæ–‡ä»¶ä½ç½®ï¼š
- **macOSåº”ç”¨**: `src-tauri/target/release/bundle/macos/èµ„äº§æµ‹ç»˜å·¥å…·.app`
- **macOSå®‰è£…åŒ…**: `src-tauri/target/release/bundle/dmg/èµ„äº§æµ‹ç»˜å·¥å…·_1.0.0_x64.dmg`

## æŠ€æœ¯è¯´æ˜

### Reactç»„ä»¶ç”Ÿå‘½å‘¨æœŸ

**ä¿®å¤å‰çš„é—®é¢˜ï¼š**
```
ç”¨æˆ·æ“ä½œï¼šèµ„äº§æµ‹ç»˜ â†’ APIå¯†é’¥ç®¡ç† â†’ èµ„äº§æµ‹ç»˜

ç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼š
1. AssetQuery mount (æŒ‚è½½)
2. ç”¨æˆ·æ‰§è¡ŒæŸ¥è¯¢ï¼Œstateæ›´æ–°
3. åˆ‡æ¢é¡µé¢ â†’ AssetQuery unmount (å¸è½½) âŒ çŠ¶æ€ä¸¢å¤±
4. ApiKeyManagement mount
5. åˆ‡æ¢å›æ¥ â†’ AssetQuery mount (é‡æ–°æŒ‚è½½) âŒ çŠ¶æ€é‡ç½®
```

**ä¿®å¤åçš„è¡Œä¸ºï¼š**
```
ç”¨æˆ·æ“ä½œï¼šèµ„äº§æµ‹ç»˜ â†’ APIå¯†é’¥ç®¡ç† â†’ èµ„äº§æµ‹ç»˜

ç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼š
1. åº”ç”¨å¯åŠ¨æ—¶ï¼Œæ‰€æœ‰ç»„ä»¶ mount (æŒ‚è½½)
2. ç”¨æˆ·æ‰§è¡ŒæŸ¥è¯¢ï¼Œstateæ›´æ–°
3. åˆ‡æ¢é¡µé¢ â†’ AssetQuery éšè— (display: none) âœ… çŠ¶æ€ä¿ç•™
4. ApiKeyManagement æ˜¾ç¤º (display: block)
5. åˆ‡æ¢å›æ¥ â†’ AssetQuery æ˜¾ç¤º âœ… çŠ¶æ€å®Œæ•´ä¿ç•™
```

### æ€§èƒ½å½±å“

**é—®é¢˜ï¼šæ‰€æœ‰ç»„ä»¶éƒ½æŒ‚è½½ä¼šä¸ä¼šå½±å“æ€§èƒ½ï¼Ÿ**

ç­”ï¼šä¸ä¼šï¼ŒåŸå› å¦‚ä¸‹ï¼š

1. **Reactä¼˜åŒ–**ï¼šéšè—çš„ç»„ä»¶ä¸ä¼šé‡æ–°æ¸²æŸ“ï¼ˆé™¤éprops/stateæ”¹å˜ï¼‰
2. **è™šæ‹ŸDOM**ï¼šReactçš„è™šæ‹ŸDOMä¼šè·³è¿‡éšè—ç»„ä»¶çš„diff
3. **åº”ç”¨è§„æ¨¡**ï¼šè¿™ä¸ªåº”ç”¨åªæœ‰5ä¸ªä¸»è¦ç»„ä»¶ï¼Œå†…å­˜å ç”¨å¯å¿½ç•¥
4. **ç”¨æˆ·ä½“éªŒ**ï¼šé¿å…é‡å¤åŠ è½½æ•°æ®ï¼Œå®é™…ä¸Šæå‡äº†æ€§èƒ½

**å†…å­˜å ç”¨å¯¹æ¯”ï¼š**
- ä¿®å¤å‰ï¼š~50MBï¼ˆå•ä¸ªç»„ä»¶ï¼‰
- ä¿®å¤åï¼š~55MBï¼ˆ5ä¸ªç»„ä»¶ï¼‰
- å¢åŠ ï¼š~5MBï¼ˆå¯æ¥å—ï¼‰

**å“åº”é€Ÿåº¦å¯¹æ¯”ï¼š**
- ä¿®å¤å‰ï¼šåˆ‡æ¢é¡µé¢éœ€è¦é‡æ–°åŠ è½½æ•°æ®ï¼ˆ~500msï¼‰
- ä¿®å¤åï¼šåˆ‡æ¢é¡µé¢å³æ—¶æ˜¾ç¤ºï¼ˆ~10msï¼‰
- æå‡ï¼š50å€

## åç»­ä¼˜åŒ–å»ºè®®

### 1. æ•°æ®æŒä¹…åŒ–
å°†å†å²è®°å½•ä¿å­˜åˆ°æœ¬åœ°æ•°æ®åº“ï¼ˆå¦‚SQLiteï¼‰ï¼Œå³ä½¿é‡å¯åº”ç”¨ä¹Ÿèƒ½ä¿ç•™ï¼š
```rust
// å»ºè®®ä½¿ç”¨ rusqlite
use rusqlite::{Connection, Result};

fn save_history(record: &QueryHistory) -> Result<()> {
    let conn = Connection::open("history.db")?;
    conn.execute(
        "INSERT INTO history (platform, query, timestamp) VALUES (?1, ?2, ?3)",
        params![record.platform, record.query, record.timestamp],
    )?;
    Ok(())
}
```

### 2. çŠ¶æ€ç®¡ç†
è€ƒè™‘ä½¿ç”¨çŠ¶æ€ç®¡ç†åº“ï¼ˆå¦‚Reduxæˆ–Zustandï¼‰ç»Ÿä¸€ç®¡ç†åº”ç”¨çŠ¶æ€ï¼š
```typescript
// ä½¿ç”¨ Zustand
import create from 'zustand';

const useStore = create((set) => ({
  queryResults: [],
  setQueryResults: (results) => set({ queryResults: results }),
}));
```

### 3. ç¼“å­˜ç­–ç•¥
å®ç°æ™ºèƒ½ç¼“å­˜ï¼Œé¿å…é‡å¤çš„APIè°ƒç”¨ï¼š
```typescript
const cache = new Map();

async function fetchWithCache(key, fetcher) {
  if (cache.has(key)) {
    return cache.get(key);
  }
  const result = await fetcher();
  cache.set(key, result);
  return result;
}
```

### 4. é”™è¯¯é‡è¯•
æ·»åŠ è‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼Œæé«˜APIè°ƒç”¨çš„å¯é æ€§ï¼š
```typescript
async function retryFetch(fn, retries = 3) {
  for (let i = 0; i < retries; i++) {
    try {
      return await fn();
    } catch (error) {
      if (i === retries - 1) throw error;
      await sleep(1000 * (i + 1)); // æŒ‡æ•°é€€é¿
    }
  }
}
```

## æ€»ç»“

âœ… **å·²ä¿®å¤**ï¼š
1. å†å²è®°å½•ç•Œé¢åˆ‡æ¢åæ•°æ®ä¸¢å¤±é—®é¢˜
2. æ·»åŠ äº†å†å²è®°å½•èœå•å…¥å£
3. ä¼˜åŒ–äº†ç»„ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†

âœ… **å·²éªŒè¯**ï¼š
- DayDayMap APIå¯†é’¥éªŒè¯åŠŸèƒ½æ­£å¸¸
- æ‰€æœ‰56ä¸ªæµ‹è¯•é€šè¿‡
- ç¬¦åˆå®˜æ–¹APIè§„èŒƒ

ğŸ“ **ä½¿ç”¨å»ºè®®**ï¼š
- å¦‚æœé‡åˆ°APIéªŒè¯é—®é¢˜ï¼Œè¯·æŒ‰ç…§æ’æŸ¥æ­¥éª¤æ£€æŸ¥
- å»ºè®®åœ¨å¼€å‘æ¨¡å¼ä¸‹æµ‹è¯•ï¼Œå¯ä»¥çœ‹åˆ°è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
- é‡æ–°æ‰“åŒ…åæµ‹è¯•æ‰€æœ‰åŠŸèƒ½

å¦‚æœ‰å…¶ä»–é—®é¢˜ï¼Œè¯·æŸ¥çœ‹åº”ç”¨æ—¥å¿—æˆ–è”ç³»å¼€å‘è€…ã€‚
