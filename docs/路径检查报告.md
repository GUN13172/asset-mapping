# é¡¹ç›®è·¯å¾„æ£€æŸ¥æŠ¥å‘Š

## æ£€æŸ¥æ—¶é—´
2026-02-06

## æ£€æŸ¥èŒƒå›´
- Rust æºä»£ç  (src-tauri/src)
- TypeScript/React æºä»£ç  (src)
- é…ç½®æ–‡ä»¶ (JSON, TOML)
- Shell è„šæœ¬

## æ£€æŸ¥ç»“æœ

### âœ… æ— ç¡¬ç¼–ç ç»å¯¹è·¯å¾„
ç»è¿‡å…¨é¢æ£€æŸ¥ï¼Œé¡¹ç›®ä¸­**æ²¡æœ‰å‘ç°ä»»ä½•ç¡¬ç¼–ç çš„ç»å¯¹è·¯å¾„**ï¼Œå¦‚ï¼š
- `/home/username/...`
- `/Users/username/...`
- `/root/...`
- `C:\Users\...`
- `D:\...`

### ğŸ“‹ è·¯å¾„ä½¿ç”¨æƒ…å†µåˆ†æ

#### 1. API ç«¯ç‚¹ URLï¼ˆæ­£å¸¸ä½¿ç”¨ï¼‰
è¿™äº›æ˜¯ API æœåŠ¡çš„ URLï¼Œä¸æ˜¯æ–‡ä»¶ç³»ç»Ÿè·¯å¾„ï¼š

**Hunter API**
- `https://hunter.qianxin.com/openApi/search`

**FOFA API**
- `https://fofa.info/api/v1/search/all`
- `https://fofa.info/api/v1/info/my`

**Quake API**
- `https://quake.360.net/api/v3/search/quake_service`
- `https://quake.360.net/api/v3/user/info`

**DayDayMap API**
- `https://www.daydaymap.com/api/v1/raymap/search/all`
- `https://www.daydaymap.com/api/v1/user/info`

#### 2. åŠ¨æ€è·¯å¾„æ„å»ºï¼ˆæ­£ç¡®å®ç°ï¼‰

**æ–‡ä»¶å¯¼å‡ºè·¯å¾„** - ä½¿ç”¨ç”¨æˆ·é€‰æ‹©çš„ç›®å½• + åŠ¨æ€æ–‡ä»¶åï¼š
```rust
// main.rs:286
let file_path = format!("{}/{}_export_{}.csv", export_path, platform, timestamp);

// history.rs:166
let file_path = format!("{}/query_history_{}.csv", export_path, timestamp);

// hunter.rs:292
let file_path = format!("{}/hunter_export_{}.csv", export_path, timestamp);

// fofa.rs:227
let file_path = format!("{}/fofa_export_{}.csv", export_path, timestamp);

// quake.rs:196
let file_path = format!("{}/quake_export_{}.csv", export_path, timestamp);

// daydaymap.rs:217
let file_path = format!("{}/{}", export_path, file_name);
```

**ç‰¹ç‚¹**ï¼š
- âœ… ä½¿ç”¨ç”¨æˆ·é€šè¿‡å¯¹è¯æ¡†é€‰æ‹©çš„ `export_path`
- âœ… ä½¿ç”¨åŠ¨æ€æ—¶é—´æˆ³ç”Ÿæˆå”¯ä¸€æ–‡ä»¶å
- âœ… è·¨å¹³å°å…¼å®¹ï¼ˆä½¿ç”¨ `/` åˆ†éš”ç¬¦ï¼ŒRust ä¼šè‡ªåŠ¨å¤„ç†ï¼‰

#### 3. ç›¸å¯¹è·¯å¾„ä½¿ç”¨ï¼ˆæ­£ç¡®å®ç°ï¼‰

**é…ç½®æ–‡ä»¶è·¯å¾„** - ä½¿ç”¨ Tauri çš„èµ„æºè§£æå™¨ï¼š
```rust
// main.rs:23-31
fn get_config_path(app_handle: &AppHandle) -> Result<PathBuf, String> {
    let resource_path = app_handle
        .path_resolver()
        .resolve_resource("config.json")
        .ok_or_else(|| "æ— æ³•æ‰¾åˆ°é…ç½®æ–‡ä»¶".to_string())?;
    
    Ok(resource_path)
}
```

**ç‰¹ç‚¹**ï¼š
- âœ… ä½¿ç”¨ Tauri çš„ `path_resolver()` API
- âœ… è‡ªåŠ¨å¤„ç†å¼€å‘æ¨¡å¼å’Œç”Ÿäº§æ¨¡å¼çš„è·¯å¾„å·®å¼‚
- âœ… è·¨å¹³å°å…¼å®¹

**è·¯å¾„æ“ä½œ** - ä½¿ç”¨æ ‡å‡†åº“çš„ Path APIï¼š
```rust
// main.rs:309
let export_dir = std::path::Path::new(file_path).parent()

// fofa.rs:238
let export_dir = Path::new(file_path).parent().unwrap();

// fofa.rs:332
let export_dir = Path::new(export_path);

// mod.rs:111
let export_dir = Path::new(export_path);
```

**ç‰¹ç‚¹**ï¼š
- âœ… ä½¿ç”¨ `std::path::Path` æ ‡å‡†åº“
- âœ… è·¨å¹³å°å…¼å®¹ï¼ˆè‡ªåŠ¨å¤„ç† Windows/Unix è·¯å¾„å·®å¼‚ï¼‰

#### 4. URL æ„å»ºï¼ˆæ­£å¸¸ä½¿ç”¨ï¼‰

**æœåŠ¡ URL æ„å»º**ï¼š
```rust
// hunter.rs:151
let url = format!("{}://{}:{}", protocol, host, port);

// quake.rs:96
"url": format!("{}://{}:{}", service["name"], ip, port)

// daydaymap.rs:109
"url": format!("{}://{}:{}", protocol, ip, port)
```

**ç‰¹ç‚¹**ï¼š
- âœ… ç”¨äºæ„å»ºç½‘ç»œæœåŠ¡ URLï¼Œä¸æ˜¯æ–‡ä»¶è·¯å¾„
- âœ… ä½¿ç”¨åŠ¨æ€æ•°æ®æ„å»º

#### 5. è¿›åº¦ä¿¡æ¯å­—ç¬¦ä¸²ï¼ˆæ­£å¸¸ä½¿ç”¨ï¼‰

**è¿›åº¦æç¤ºæ–‡æœ¬**ï¼š
```rust
// main.rs:170
status_text: format!("æ­£åœ¨è·å–ç¬¬ {}/{} é¡µ...", page, pages)

// hunter.rs:226
eprintln!("æ­£åœ¨å¯¼å‡ºç¬¬ {}/{} é¡µ...", page, pages);
```

**ç‰¹ç‚¹**ï¼š
- âœ… ä»…ç”¨äºæ˜¾ç¤ºè¿›åº¦ä¿¡æ¯
- âœ… ä¸æ¶‰åŠæ–‡ä»¶ç³»ç»Ÿæ“ä½œ

#### 6. HTTP åè®®æ£€æŸ¥ï¼ˆæ­£å¸¸ä½¿ç”¨ï¼‰

**URL éªŒè¯**ï¼š
```rust
// utils/mod.rs:75
url.starts_with("http://") || url.starts_with("https://")
```

**ç‰¹ç‚¹**ï¼š
- âœ… ç”¨äºéªŒè¯ URL æ ¼å¼
- âœ… ä¸æ˜¯æ–‡ä»¶ç³»ç»Ÿè·¯å¾„

## è·¯å¾„å®‰å…¨æ€§è¯„ä¼°

### âœ… ä¼˜ç‚¹
1. **æ— ç¡¬ç¼–ç è·¯å¾„**ï¼šæ‰€æœ‰è·¯å¾„éƒ½æ˜¯åŠ¨æ€ç”Ÿæˆæˆ–ç”¨æˆ·é€‰æ‹©
2. **è·¨å¹³å°å…¼å®¹**ï¼šä½¿ç”¨æ ‡å‡†åº“ APIï¼Œè‡ªåŠ¨å¤„ç†å¹³å°å·®å¼‚
3. **ç”¨æˆ·æ§åˆ¶**ï¼šå¯¼å‡ºè·¯å¾„ç”±ç”¨æˆ·é€šè¿‡å¯¹è¯æ¡†é€‰æ‹©
4. **å®‰å…¨æ€§å¥½**ï¼šä½¿ç”¨ Tauri çš„å®‰å…¨ APIï¼Œä¸ç›´æ¥æ“ä½œæ–‡ä»¶ç³»ç»Ÿ

### ğŸ“ å»ºè®®
1. **è·¯å¾„éªŒè¯**ï¼šåœ¨ä½¿ç”¨ç”¨æˆ·æä¾›çš„è·¯å¾„å‰ï¼Œå»ºè®®æ·»åŠ éªŒè¯ï¼š
   - æ£€æŸ¥è·¯å¾„æ˜¯å¦å­˜åœ¨
   - æ£€æŸ¥æ˜¯å¦æœ‰å†™å…¥æƒé™
   - é˜²æ­¢è·¯å¾„éå†æ”»å‡»ï¼ˆå¦‚ `../../../etc/passwd`ï¼‰

2. **é”™è¯¯å¤„ç†**ï¼šå¢å¼ºè·¯å¾„æ“ä½œçš„é”™è¯¯å¤„ç†ï¼š
   ```rust
   // å½“å‰ä»£ç 
   let export_dir = Path::new(file_path).parent().unwrap();
   
   // å»ºè®®æ”¹è¿›
   let export_dir = Path::new(file_path).parent()
       .ok_or_else(|| "æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„".to_string())?;
   ```

3. **è·¯å¾„è§„èŒƒåŒ–**ï¼šä½¿ç”¨ `canonicalize()` è§„èŒƒåŒ–è·¯å¾„ï¼š
   ```rust
   let canonical_path = std::fs::canonicalize(export_path)
       .map_err(|e| format!("è·¯å¾„è§„èŒƒåŒ–å¤±è´¥: {}", e))?;
   ```

## é…ç½®æ–‡ä»¶è·¯å¾„

### Tauri é…ç½®
**æ–‡ä»¶**: `src-tauri/tauri.conf.json`
```json
{
  "build": {
    "devPath": "http://localhost:1420",  // å¼€å‘æœåŠ¡å™¨ URL
    "distDir": "../dist"                  // ç›¸å¯¹è·¯å¾„
  }
}
```
- âœ… ä½¿ç”¨ç›¸å¯¹è·¯å¾„
- âœ… devPath æ˜¯ URLï¼Œä¸æ˜¯æ–‡ä»¶è·¯å¾„

### TypeScript é…ç½®
**æ–‡ä»¶**: `tsconfig.json`
```json
{
  "references": [{ "path": "./tsconfig.node.json" }]
}
```
- âœ… ä½¿ç”¨ç›¸å¯¹è·¯å¾„

## æ€»ç»“

### ğŸ‰ æ£€æŸ¥é€šè¿‡
é¡¹ç›®ä¸­**æ²¡æœ‰ç¡¬ç¼–ç çš„ç»å¯¹è·¯å¾„**ï¼Œæ‰€æœ‰è·¯å¾„ä½¿ç”¨éƒ½ç¬¦åˆæœ€ä½³å®è·µï¼š
- âœ… ä½¿ç”¨ç›¸å¯¹è·¯å¾„
- âœ… ä½¿ç”¨æ ‡å‡†åº“ API
- âœ… ä½¿ç”¨ Tauri æ¡†æ¶æä¾›çš„è·¯å¾„è§£æå™¨
- âœ… ç”¨æˆ·é€‰æ‹©å¯¼å‡ºè·¯å¾„
- âœ… è·¨å¹³å°å…¼å®¹

### ğŸ“Š ç»Ÿè®¡
- **API URL**: 8 ä¸ªï¼ˆæ­£å¸¸ï¼‰
- **åŠ¨æ€æ–‡ä»¶è·¯å¾„**: 6 ä¸ªï¼ˆæ­£ç¡®ï¼‰
- **ç›¸å¯¹è·¯å¾„**: 4 ä¸ªï¼ˆæ­£ç¡®ï¼‰
- **ç¡¬ç¼–ç ç»å¯¹è·¯å¾„**: 0 ä¸ªï¼ˆâœ… é€šè¿‡ï¼‰

### ğŸ”’ å®‰å…¨æ€§
- **é£é™©ç­‰çº§**: ä½
- **å»ºè®®**: æ·»åŠ è·¯å¾„éªŒè¯å’Œè§„èŒƒåŒ–
- **ä¼˜å…ˆçº§**: ä¸­ç­‰ï¼ˆå¯é€‰ä¼˜åŒ–ï¼‰

## ç›¸å…³æ–‡ä»¶
- `asset-mapping/src-tauri/src/main.rs` - ä¸»è¦è·¯å¾„æ“ä½œ
- `asset-mapping/src-tauri/src/api/*.rs` - API è°ƒç”¨å’Œæ–‡ä»¶å¯¼å‡º
- `asset-mapping/src-tauri/src/history.rs` - å†å²è®°å½•å¯¼å‡º
- `asset-mapping/src-tauri/tauri.conf.json` - Tauri é…ç½®
- `asset-mapping/tsconfig.json` - TypeScript é…ç½®
